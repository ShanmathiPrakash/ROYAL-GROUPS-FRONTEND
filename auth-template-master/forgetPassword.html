<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Matteo Bruni">
    <title>Signin Template - tsParticles</title>

    <!-- Custom styles for this template -->
    <link href="css/particles.css" rel="stylesheet"/>
    <link href="css/auth.css" rel="stylesheet"/>
</head>
<body>
    <div id="tsparticles"></div>
    <main class="box">
        <h2>Login</h2>
        <form id="loginForm">
            <div class="inputBox">
                <label for="userName">Mail Id</label>
                <input type="text" name="userName" id="userName" placeholder="Type your registered mail Id" required />
            <div>
                <button type="submit" name="loginButton" style="float: left;">Submit</button>
                 <a class="button" href="register.html" style="float: left;">Forget Password</a>
            </div>
           
        </form>
    </main>


    <script src="https://cdn.jsdelivr.net/npm/tsparticles@1.34.1/tsparticles.min.js"
            integrity="sha256-D6LXCdCl4meErhc25yXnxIFUtwR96gPo+GtLYv89VZo=" crossorigin="anonymous"></script>
    <script>
        console.log("JavaScript file loaded");
        document.addEventListener("DOMContentLoaded", function () {
            const loginForm = document.getElementById("loginForm");

            loginForm.addEventListener("submit", function (e)
            { 
                e.preventDefault();
                const mail = document.getElementById("userName").value;
                

               // const userNameInput = document.getElementById("userName");
              //  const userPasswordInput = document.getElementById("userPassword");

              // const Firstname = mail.value();
                //const password = userPasswordInput.value;

                console.log(mail); // Debug: Check if username is correctly trimmed
               // const mailInput = document.getElementById("userName");
                //const mail = mailInput.value.trim(); // Trim whitespace

 // Call the function to send OTP
    handleGenerateOTP(mail);

              //  const loginRequest = {
                //    Firstname: Firstname,
                  //  Password: password
               // };
             
               
              });
               function  handleGenerateOTP(mail) {
    // Send a request to the backend API to delete the user with the specified firstname
    fetch(`http://localhost:8080/api/otp/generate/${encodeURIComponent(mail)}`, {
        method: 'POST'
    })
    .then(response => response.text())
.then(data => {
    
    alert("Mail sended  successfully");

        // Check the role input valu
    
})
.catch(error => {
    console.error('Error:', error);
    alert('An error occurred while registering the user.');
});
    }




/*
function handleDeleteUser(firstname) {
    // Send a request to the backend API to delete the user with the specified firstname
    fetch(`http://localhost:8080/User/delete_user/${encodeURIComponent(firstname)}`, {
        method: 'DELETE'
    })
    .then(response => {
        if (response.ok) {
            // User deleted successfully in the backend
            // Now, remove the corresponding row from the UI
            const userTable = document.getElementById('userTable');
            const tbody = userTable.querySelector('tbody');
            const rows = tbody.getElementsByTagName('tr');

            for (let i = 0; i < rows.length; i++) {
                const usernameCell = rows[i].getElementsByTagName('td')[0];
                if (usernameCell.textContent === firstname) {
                    tbody.removeChild(rows[i]);
                    break; // Stop searching after deletion
                }
            }
        } else {
            console.error('Failed to delete user:', response.status);
        }
    })
    .catch(error => console.error('Error deleting user:', error));
}





fetch("http://localhost:8080/User/login", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(loginRequest)
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Login failed");
                    }
                    return response.text();
                })
                
                .catch(error => {
                    console.error(error);
                    alert("Login failed. Please check your username and password.");
                 });
   
*/
                });
    
    </script>
</body>

</html>

